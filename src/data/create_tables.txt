CREATE TABLE model_risk (
  brand TEXT,
  model TEXT,
  total INTEGER,
  percentage DOUBLE PRECISION,
  model_risk DOUBLE PRECISION
);

CREATE TABLE postcode_risk (
  postcode TEXT,
  locality TEXT,
  long DOUBLE PRECISION,
  lat DOUBLE PRECISION,
  lgaregion TEXT,
  local_government_area TEXT,
  motorcycle_theft_rate DOUBLE PRECISION,
  postcode_risk DOUBLE PRECISION
);

CREATE TABLE default_risk (
  model_default_risk DOUBLE PRECISION,
  postcode_default_risk DOUBLE PRECISION
);

CREATE TABLE user_input (
  input_id DOUBLE PRECISION,
  input_type TEXT,
  postcode TEXT,
  brand TEXT,
  input TEXT
);

CREATE TABLE user_contribution (
  parking_id INTEGER PRIMARY KEY AUTOINCREMENT,
  address TEXT NOT NULL,
  suburb TEXT NOT NULL,
  postcode TEXT NOT NULL,
  type TEXT CHECK(type IN ('on-street', 'off-street', 'secure')) NOT NULL,
  /* The integers map to the UI, poor (1), fair (2), good (3), excellent (4) */
  lighting INTEGER CHECK(lighting IN (1, 2, 3, 4)),
  cctv BOOLEAN,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE facilities (
  facility_id INTEGER PRIMARY KEY AUTOINCREMENT, 
  facility_name TEXT NOT NULL UNIQUE 
);

CREATE TABLE user_contribution_facilities (
  parking_id INTEGER NOT NULL,
  facility_id INTEGER NOT NULL,
  PRIMARY KEY (parking_id, facility_id), 
  FOREIGN KEY (parking_id) REFERENCES user_contributions(parking_id) ON DELETE CASCADE, 
  FOREIGN KEY (facility_id) REFERENCES facilities(facility_id) ON DELETE CASCADE
);

INSERT INTO facilities (facility_name) VALUES 
('Toilet'),
('Cafe'),
('Lockers'),
('Covered parking'),
('Security guard'),
('Accessible');

CREATE TABLE votes (
  vote_id INTEGER PRIMARY KEY AUTOINCREMENT, 
  parking_id INTEGER NOT NULL,  
  vote_type TEXT CHECK(vote_type IN ('upvote', 'downvote')) NOT NULL, 
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, 
  FOREIGN KEY (parking_id) REFERENCES user_contributions(parking_id) ON DELETE CASCADE
);

CREATE TABLE victorian_addresses (
    address TEXT NOT NULL,
    suburb TEXT NOT NULL,
    postcode TEXT NOT NULL
);

CREATE TABLE carpark_counts (
    postcode TEXT NOT NULL,
    carpark_count INTEGER NOT NULL
);

CREATE TABLE street_light_coverage (
    postcode TEXT NOT NULL,
    area_km2 INTEGER,
    light_count INTEGER,
    lights_per_km2 DOUBLE PRECISION
);

CREATE TABLE crime_data (
    postcode TEXT NOT NULL,
    offence_division TEXT NOT NULL,
    offence_subdivision TEXT NOT NULL,
    offence_subgroup TEXT NOT NULL,
    offence_count INTEGER NOT NULL
);

